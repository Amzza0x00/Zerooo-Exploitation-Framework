"""
HttpClient classes

封装requests
"""
import urllib3
from zerooosploit.color import *
try:
    import requests
except ImportError:
    print_red('[-] Please install requests, python3 -m pip install requests')


urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)


class HttpClient(object):

    def __init__(self):
        self.http_headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:60.0)Gecko/20100101 Firefox/60.0'}
        self.http_timeout = 60
        self.ssl_verify = False
        self.http_allow_redirects = False

    def send_request_cgi(self, method, url, **kwargs):

        kwargs.setdefault('timeout', self.http_timeout)
        kwargs.setdefault('headers', self.http_headers)
        kwargs.setdefault('verify', self.ssl_verify)
        kwargs.setdefault('allow_redirects', self.http_allow_redirects)

        try:
            res = requests.request(method, url, **kwargs)
            return res
        except (requests.exceptions.MissingSchema, requests.exceptions.InvalidSchema):
            print_red('[-] Invalid URL format: {}'.format(url))
        except requests.exceptions.Timeout:
            print_red('[-] {} Error: Timeout'.format(url))
        except requests.exceptions.ConnectionError:
            print_red('[-] {} Error: ConnectionError'.format(url))

        return None
