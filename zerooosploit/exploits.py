'''
exploits classes

解析exp，用户可以设置exploit对应属性
'''


class ExploitAggregate:
    '''初始化Exp所需属性'''

    def __init__(self, target_ip=None, target_port=None, target_os=None):
        self.target_ip = target_ip
        self.target_port = target_port
        self.target_os = target_os

    def select_modules(self, modules):
        '''动态加载模块'''
        import importlib
        return importlib.import_module(name=('modules.' + modules))  # 返回对应模块对象

    def del_modules(self, modules):
        '''卸载模块'''
        del modules

    def exploit(self, modules):
        '''调用模块里的main函数'''
        return self.select_modules(modules).main()  # 执行
