"""
exploits classes

解析exp，用户可以设置exploit对应属性
"""


class ExploitAggregate:
    """初始化Exp所需属性"""

    def __init__(self, modules=None, target_ip=None, target_port=None, target_os=None):
        self.modules = modules
        self.target_ip = target_ip
        self.target_port = target_port
        self.target_os = target_os

    def select_modules(self):
        """动态加载模块"""
        import importlib
        # import os
        # os.chdir(os.getcwd() + '/modules/')  # 改变当前工作目录
        # os.chdir(os.getcwd() + '/test/')
        # res = self.modules
        return importlib.import_module(name=('modules.' + self.modules))  # 返回对应模块对象

    def del_modules(self):
        """卸载模块"""
        del self.modules

    def exploit(self):
        """调用模块里的main函数"""
        # print(dir(self.select_modules()))
        return self.select_modules().main()  # 执行

